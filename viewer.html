<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>github.com/etrusci-org/quotes</title>
    <style>
        html, body {
            display: grid;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #000;
        }

        .quotes {
            margin: auto;
            color: #fff;
            mix-blend-mode: difference;
            text-align: center;
        }

        html {
            font-size: min(max(1rem, 4vw), 30rem);
        }

        .quotes {
            padding: min(max(1rem, 4vw), 8rem);
        }
    </style>
</head>
<body>
    <div class="quotes"></div>

    <script src="https://cdn.jsdelivr.net/gh/etrusci-org/olay@2.3.2/app/lib/fetchjson.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/etrusci-org/olay@2.3.2/app/lib/fyshuffle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/etrusci-org/olay@2.3.2/app/lib/randomquotetyper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/etrusci-org/olay@2.3.2/app/lib/getrandomcolorhex.min.js"></script>
    <script>
        // Config
        const QUOTES_SRC = './json/quotes.min.json'
        const QUOTES_UPDATE_RATE = 60 * 1000 // ms
        const TARGET_SELECTOR = '.quotes'
        const TYPING_SPEED = 60 // ms

        // Update func
        async function runRandomQuotesViewer()
        {
            // fetch quotes
            const quotes = await fetchJSON(QUOTES_SRC)

            // nifty bg color changer func
            const setRandomBG = () => {
                document.body.style.backgroundColor = `#${getRandomColorHex()}`
            }

            // set bg transition style
            document.body.style.transition = `background-color ${(QUOTES_UPDATE_RATE/2)/1000}s ease 0s`

            // change bg to first color
            setRandomBG()

            // init random quote typer
            RandomQuoteTyper.targetSelector = TARGET_SELECTOR
            RandomQuoteTyper.typingSpeed = TYPING_SPEED
            RandomQuoteTyper.init(quotes)

            // type first quote
            RandomQuoteTyper.typeQuote()

            // repeat until the world stops turning
            setInterval(() => {
                setRandomBG()
                RandomQuoteTyper.typeQuote()
            }, QUOTES_UPDATE_RATE)
        }

        // Reg event listener that will start the viewer
        window.addEventListener('load', () => {
            runRandomQuotesViewer()
        }, false)
    </script>
</body>
</html>
